@model List<PatientListVM>

<div class="container mt-4">
    <div class="row g-4">

        @foreach (var p in Model)
        {
            <div class="col-md-6 col-xl-4">
                <div class="card shadow-sm p-3">

                    <!-- Patient Name -->
                    <h4 class="fw-bold">@p.FirstName @p.LastName</h4>

                    <!-- Status Badge -->
                    <span class="badge
                            @(p.Status == "Active" ? "bg-success"
                                                  : p.Status == "Alert" ? "bg-danger"
                                                  : "bg-secondary")">
                    @p.Status
                </span>

                    <p class="text-muted mt-2">ID: @p.PatientId</p>

                    <!-- Dropdown -->
                    <div class="dropdown">
                        <button class="btn btn-outline-secondary dropdown-toggle w-100" type="button" data-bs-toggle="dropdown">
                            See More
                        </button>

                        <ul class="dropdown-menu">

                            <li>
                                <a class="dropdown-item"
                                   asp-area="Admin"
                                   asp-controller="Patients"
                                   asp-action="Details"
                                   asp-route-id="@p.PatientId">
                                    Edit Patient Data
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item"
                                   asp-area="Admin"
                                   asp-controller="Patients"
                                   asp-action="Details"
                                   asp-route-id="@p.PatientId">
                                    View Appointment History
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item"
                                   asp-area="Admin"
                                   asp-controller="Patients"
                                   asp-action="Details"
                                   asp-route-id="@p.PatientId">
                                    View Profile
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item"
                                   asp-area="Admin"
                                   asp-controller="Patients"
                                   asp-action="Details"
                                   asp-route-id="@p.PatientId">
                                    Upcoming Appointments
                                </a>
                            </li>

                            <li><hr class="dropdown-divider"></li>

                            <li>
                                <a class="dropdown-item text-danger"
                                   asp-area="Admin"
                                   asp-controller="Patients"
                                   asp-action="Delete"
                                   asp-route-id="@p.PatientId">
                                    Delete Record
                                </a>
                            </li>

                        </ul>
                    </div>


                </div>
            </div>
          }

    </div>

</div> 


    <!-- Pagination -->
    <nav class="mt-4">
        <ul class="pagination justify-content-center">

            <li class="page-item @(ViewBag.CurrentPage == 1 ? "disabled" : "")">
                <a class="page-link" href="?page=@(ViewBag.CurrentPage - 1)">«</a>
            </li>

            @for (int i = 1; i <= ViewBag.TotalPages; i++)
            {
                <li class="page-item @(i == ViewBag.CurrentPage ? "active" : "")">
                    <a class="page-link" href="?page=@i">@i</a>
                </li>
            }

            <li class="page-item @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "")">
                <a class="page-link" href="?page=@(ViewBag.CurrentPage + 1)">»</a>
            </li>

        </ul>
    </nav>


@section Scripts {
    <script>
        document.querySelectorAll(".dropdown-item").forEach(item => {
            item.addEventListener("click", function () {
                window.location = this.href;
            });
        });
    </script>
}