@model AlertsListVM
@{
    Layout = "~/Areas/Admin/Views/Shared/_DashboardLayout.cshtml";
}

<!-- FILTER BAR -->
<form method="get" class="mb-3 d-flex" style="gap:10px;">
    <select name="priority" class="form-select" style="width:200px;">
        <option value="" selected="@(Model.SelectedPriority == "" ? "selected" : null)">All Priorities</option>

        <option value="Critical" selected="@(Model.SelectedPriority == "Critical" ? "selected" : null)">
            Critical
        </option>
        <option value="High" selected="@(Model.SelectedPriority == "High" ? "selected" : null)"> 
            High
        </option>
        <option value="Medium" selected="@(Model.SelectedPriority == "Medium" ? "selected" : null)">
            Medium
        </option>
        <option value="Low" selected="@(Model.SelectedPriority == "Low" ? "selected" : null)">
            Low
        </option>
    </select>

    <button type="submit" class="btn btn-primary">Filter</button>
</form>

<div class="container mt-4">

    <h3 class="fw-bold mb-3">Alerts</h3>

    <div class="table-responsive" style="max-height:500px; overflow-y:auto;">
        <table class="table table-bordered table-striped table-hover">
            <thead class="table-light">
                <tr>
                    <th>Alert-Id</th>
                    <th>Type</th>
                    <th>Message</th>
                    <th>Priority</th>
                    <th>Status</th>
                    <th>Related-id</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var a in Model.Alerts)
                {
                    @* Assign color classes based on priority *@
                    var rowClass =
                        a.Priority == "Critical" ? "table-danger" :
                        a.Priority == "High" ? "table-warning" :
                        a.Priority == "Medium" ? "table-info" :
                        "table-light";

                    <tr class="@rowClass">
                        <td>@a.AlertCode</td>
                        <td>@a.Type</td>
                        <td>@a.Message</td>
                        <td>@a.Priority</td>
                        <td>@a.Status</td>
                        <td>@a.RelatedId</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- PAGINATION -->
    <nav class="mt-3">
        <ul class="pagination justify-content-center">

            <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
                <a class="page-link" href="?page=@(Model.CurrentPage - 1)&priority=@Model.SelectedPriority">«</a>
            </li>

            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                <li class="page-item @(Model.CurrentPage == i ? "active" : "")">
                    <a class="page-link" 
                       href="?page=@i&priority=@Model.SelectedPriority">@i</a>
                </li>
            }

            <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                <a class="page-link" href="?page=@(Model.CurrentPage + 1)&priority=@Model.SelectedPriority">»</a>
            </li>

        </ul>
    </nav>

</div>
